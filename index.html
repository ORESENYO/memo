<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>【NGH】問い合わせ対応ツール</title>

<style>
/* ========= Base ========= */
:root{
  --font-ui: "Meiryo UI", sans-serif;
  --label-size: 20pt;
  --text-size: 10pt;
  --gap: 8px;
  --border: 1px solid #999;
  --border-soft: 1px solid #ccc;
  --bg: #f5f5f5;
  --active: #0078d4;
}

body{
  font-family: var(--font-ui);
  margin: 20px;
  color: #111;
}

.section{ margin-bottom: 24px; }
.label{
  font-size: var(--label-size);
  font-weight: bold;
  margin-bottom: 8px;
}

.buttons{
  display: flex;
  flex-wrap: wrap;
  gap: var(--gap);
}

button{
  padding: 8px 14px;
  font-size: var(--text-size);
  cursor: pointer;
  border: var(--border);
  background: var(--bg);
  border-radius: 4px;
}
button.active{
  background: var(--active);
  color: #fff;
  border-color: var(--active);
}

/* 未実装：クリック可能だがグレー表示 */
button.disabled{
  background: #ddd;
  color: #888;
}

/* ========= Accordion ========= */
.accordion{
  margin-top: 10px;
  padding: 10px;
  border: var(--border-soft);
  display: none;
  border-radius: 4px;
}
.accordion label{
  display: block;
  margin-bottom: 6px;
  font-size: var(--text-size);
  cursor: pointer;
}

/* ========= Hearing Result ========= */
textarea#resultText{
  width: 100%;
  height: 180px;
  font-size: var(--text-size);
  box-sizing: border-box;
  padding: 10px;
  resize: vertical;
}

.footer-buttons{
  display: flex;
  gap: 12px;
}

/* ========= Modal ========= */
.modal{
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  z-index: 1000;
}
.modal-content{
  background: #fff;
  width: 640px;
  max-width: calc(100% - 24px);
  max-height: 70vh;
  margin: 80px auto;
  padding: 16px;
  border-radius: 6px;

  overflow-y: auto;
  overflow-x: hidden;

  font-size: var(--text-size);
  box-sizing: border-box;
  position: relative;
}

/* Tabs */
.tabs{
  display: flex;
  border-bottom: var(--border-soft);
  margin-bottom: 10px;
  gap: 0;
}
.tab{
  padding: 6px 12px;
  cursor: pointer;
  user-select: none;
}
.tab.active{
  border-bottom: 2px solid var(--active);
  font-weight: bold;
}

/* Mail Preview */
.preview-block{
  border: var(--border-soft);
  border-radius: 4px;
  padding: 10px;
}
.preview-row{ margin-bottom: 10px; }
.preview-label{
  font-weight: bold;
  margin-bottom: 4px;
  display: block;
}
.preview-ta-subject{
  width: 100%;
  font-size: var(--text-size);
  line-height: 1.6;
  height: calc(1.6em + 16px);
  padding: 8px;
  box-sizing: border-box;
  resize: none;
  overflow: hidden;
  white-space: nowrap;
}

.preview-ta-body{
  width: 100%;
  height: 220px;
  font-size: var(--text-size);
  padding: 8px;
  box-sizing: border-box;
  resize: vertical;
}

/* Confirm button fixed left-bottom inside modal */
.modal-fixed-actions{
  position: sticky;
  bottom: 0;
  background: #fff;
  padding-top: 10px;
  margin-top: 10px;
  display: flex;
  justify-content: flex-start;
  gap: 8px;
  border-top: var(--border-soft);
}

/* Form controls (Tab4) */
.form-row{ margin-bottom: 12px; }
select, input[type="text"]{
  font-size: var(--text-size);
  padding: 6px;
  min-width: 260px;
  box-sizing: border-box;
}

/* Error message modal table */
.search-box{
  width: 100%;
  padding: 8px;
  font-size: var(--text-size);
  box-sizing: border-box;
  margin-bottom: 10px;
}
.error-table{
  width: 100%;
  border-collapse: collapse;
}
.error-table td{
  border: var(--border-soft);
  padding: 8px;
}
.error-row{
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

/* Small helper text */
.small{ font-size: var(--text-size); color:#333; }
</style>
</head>

<body>

<!-- ■問い合わせ内容 -->
<div class="section">
  <div class="label">■ 問い合わせ内容</div>
  <div class="buttons" id="inquiryButtons">
    <button id="btnInquiryMail" onclick="onInquiryClick(this,'認証コード未着')">認証コード未着</button>
    <button id="btnInquiryMsg" onclick="onInquiryClick(this,'エラーメッセージ')">エラーメッセージ</button>
    <button onclick="onMigrationJudge(this)">移行対象判定</button>

    <button class="disabled" onclick="notImplemented()">未実装</button>
    <button class="disabled" onclick="notImplemented()">未実装</button>
    <button class="disabled" onclick="notImplemented()">未実装</button>
  </div>
</div>

<!-- ■利用環境 -->
<div class="section">
  <div class="label">■ 利用環境</div>
  <div class="buttons" id="deviceButtons">
    <button onclick="toggleDevice(this,'iPhone')">iPhone</button>
    <button onclick="toggleDevice(this,'Android')">Android</button>
    <button onclick="toggleDevice(this,'パソコン')">パソコン</button>
    <button onclick="toggleDevice(this,'タブレット')">タブレット</button>
    <button onclick="toggleDevice(this,'TV')">TV</button>
  </div>

  <div id="accordion" class="accordion">
    <div id="accordionContent"></div>
  </div>
</div>

<!-- ■ヒアリング結果 -->
<div class="section">
  <div class="label">■ ヒアリング結果</div>
  <textarea id="resultText" readonly></textarea>
</div>

<!-- footer -->
<div class="section footer-buttons">
  <button onclick="alert('（エスカレーションは後で実装します）')">エスカレーション</button>
  <button onclick="copyText()">コピー</button>
  <button onclick="resetAll()">リセット</button>
</div>

<!-- ===== 認証コード未着モーダル ===== -->
<div id="mailModal" class="modal" onclick="closeModal(event,'mailModal')">
  <div class="modal-content" onclick="event.stopPropagation()">

    <div class="tabs">
      <div class="tab active" onclick="switchMailTab(this,'S_MIG')">Sアカ移行</div>
      <div class="tab" onclick="switchMailTab(this,'S_NEW')">Sアカ新規</div>
      <div class="tab" onclick="switchMailTab(this,'J_NEW')">Jアカ新規</div>
      <div class="tab" onclick="switchMailTab(this,'NO_RECV')">受信なし</div>
    </div>

    <div id="mailPreview" class="preview-block">
      <div class="preview-row">
        <span class="preview-label">件名</span>
        <textarea id="mailSubjectTA" class="preview-ta-subject" readonly></textarea>
      </div>

      <div class="preview-row">
        <span class="preview-label">本文</span>
        <textarea id="mailBodyTA" class="preview-ta-body" readonly></textarea>
      </div>
    </div>

    <div id="mailExtra" style="display:none;">
      <div class="form-row">
        <strong>ドメイン（＠以降の文字列）</strong><p>
        <select id="extraDomain" onchange="onDomainSelectChange()">
          <option value="">選択してください</option>
          <option value="@gmail.com">@gmail.com</option>
          <option value="@yahoo.co.jp">@yahoo.co.jp</option>
          <option value="@icloud.com">@icloud.com</option>
          <option value="@au.com">@au.com</option>
          <option value="@ezweb.ne.jp">@ezweb.ne.jp</option>
          <option value="@softbank.ne.jp">@softbank.ne.jp</option>
          <option value="@i.softbank.ne.jp">@i.softbank.ne.jp</option>
          <option value="@docomo.ne.jp">@docomo.ne.jp</option>
          <option value="@outlook.com">@outlook.com</option>
          <option value="__manual__">その他（手入力）</option>
        </select>

        <div id="domainManualWrap" style="display:none; margin-top:8px;">
          <input id="extraDomainManual" type="text" placeholder="例）@example.com">
        </div>
      </div>

      <div class="form-row">
        <label><input id="cbMistake" type="checkbox"> メールアドレスの入力ミス</label><br>
        <label><input id="cbReject" type="checkbox"> 受信拒否</label><br>
        <label><input id="cbSpam" type="checkbox"> 迷惑メールフィルター</label>
      </div>
    </div>

    <div class="modal-fixed-actions">
      <button onclick="confirmMailModal()">確定</button>
    </div>

  </div>
</div>

<!-- ===== エラーメッセージモーダル ===== -->
<div id="errorModal" class="modal" onclick="closeModal(event,'errorModal')">
  <div class="modal-content" onclick="event.stopPropagation()">

    <input id="errorSearch" class="search-box" type="text"
      placeholder="検索（例：E002 / 認証）" oninput="renderErrorTable()">

    <table class="error-table">
      <tbody id="errorMsgTableBody"></tbody>
    </table>

  </div>
</div>

<script src="app.js"></script>
</body>
</html>
