<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>コード表示 — sheet1 / UserForm</title>
  <meta name="description" content="指定された文字列（VBAコード）をそのまま表示するページ。コピー機能付き。" />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>コード表示ページ</h1>
  </header>

  <main>
    <section aria-labelledby="sheet1-heading" class="card">
      <div class="card-header">
        <h2 id="sheet1-heading"></h2>
        <div class="actions">
        </div>
      </div>
      <div class="card-body">
        <pre><code id="code-sheet1" tabindex="0" aria-label="sheet1 コード">
〓〓〓〓〓sheet1〓〓〓〓〓
' E列をダブルクリックでUserForm2を起動
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
If Target.Column = 5 And Target.Row > 1 Then
Cancel = True
UserForm2.Show vbModeless
' TextBにF列の値を出力
UserForm2.TextB.Value = Me.Cells(Target.Row, 6).Value
' 行番号を保持
UserForm2.Tag = Target.Row
End If
End Sub
〓〓〓〓〓UserForm〓〓〓〓〓
Option Explicit

Private dataArr As Variant
Private headers As Variant

'--- 初期化処理（UserForm2起動時）
Private Sub UserForm_Initialize()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim dict As Object, i As Long
    
    Set ws = ThisWorkbook.Sheets(1) ' 対象シートを指定
    lastRow = ws.Cells(ws.Rows.Count, "B").End(xlUp).Row
    If lastRow < 2 Then Exit Sub
    
    ' データ全体を配列に格納（2行目以降）
    dataArr = ws.Range("A2:F" & lastRow).Value
    
    ' カテゴリを重複排除してComboAへ
    Set dict = CreateObject("Scripting.Dictionary")
    For i = 1 To UBound(dataArr)
        If Len(dataArr(i, 2)) > 0 Then dict(dataArr(i, 2)) = 1
    Next
    Me.ComboA.List = dict.Keys
    
    ' ListAのカラム数設定（C, D列のみ表示）
    Me.ListA.ColumnCount = 2
    Me.ListA.ColumnWidths = "100;150"
    
    ' 初期表示（全件）
    FilterList
End Sub

'--- ComboAやTextAの変更でフィルタリング
Private Sub ComboA_Change()
    FilterList
End Sub

Private Sub TextA_Change()
    FilterList
End Sub

'--- リストを絞り込み表示
Private Sub FilterList()
    Dim i As Long, tmp As Collection, rowArr As Variant
    Dim words() As String, w As Variant
    Dim cat As String, txt As String, hit As Boolean
    
    cat = Trim(Me.ComboA.Value)
    txt = Trim(Me.TextA.Value)
    
    Set tmp = New Collection
    
    If Len(txt) > 0 Then words = Split(txt, " ")
    
    For i = 1 To UBound(dataArr)
        ' カテゴリ一致チェック
        If (cat = "" Or dataArr(i, 2) = cat) Then
            hit = True
            ' テキスト検索
            If Len(txt) > 0 Then
                For Each w In words
                    If InStr(1, dataArr(i, 2) & dataArr(i, 3) & dataArr(i, 4) & dataArr(i, 6), w, vbTextCompare) = 0 Then
                        hit = False
                        Exit For
                    End If
                Next
            End If
            ' 該当データをListAに格納（C列, D列）
            If hit Then
                rowArr = Array(dataArr(i, 3), dataArr(i, 4))
                tmp.Add rowArr
            End If
        End If
    Next
    
    ' ListAに反映
    If tmp.Count > 0 Then
        ReDim rowArr(1 To tmp.Count, 1 To 2)
        For i = 1 To tmp.Count
            rowArr(i, 1) = tmp(i)(0)
            rowArr(i, 2) = tmp(i)(1)
        Next
        Me.ListA.List = rowArr
    Else
        Me.ListA.Clear
    End If
End Sub

'--- ListAをダブルクリックでE列を表示
Private Sub ListA_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Dim i As Long
    If Me.ListA.ListIndex = -1 Then Exit Sub
    
    For i = 1 To UBound(dataArr)
        If dataArr(i, 3) = Me.ListA.List(Me.ListA.ListIndex, 0) And _
           dataArr(i, 4) = Me.ListA.List(Me.ListA.ListIndex, 1) Then
           
           Me.TextB.Value = dataArr(i, 5) ' E列を表示
           ThisWorkbook.Sheets(1).Cells(i + 1, 5).Activate
           Exit For
        End If
    Next
End Sub

'--- リセットボタン（ComboA, TextAをクリアして全件表示）
Private Sub cmdReset_Click()
    Me.ComboA.Value = ""
    Me.TextA.Value = ""
    FilterList
End Sub
        </code></pre>
      </div>
    </section>

    <aside class="notes" aria-label="補助情報">
      <h3></h3>
      <p></p>
    </aside>
  </main>

  <footer>
    <p><!-- 自動で差し替え --> <time id="today"></time></p>
    <p><small></small></p>
  </footer>

  <script src="script.js" defer></script>
</body>
</html>